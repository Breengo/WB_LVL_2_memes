(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function c(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=c(r);fetch(r.href,i)}})();const v=document.querySelector("#file_input"),o=document.querySelector("#canv"),S=document.querySelector("#text_manager").querySelector("input"),u=document.querySelector("#fontSize"),y=document.querySelector(".color_picker"),l=o.getContext("2d");o.height=800;o.width=1200;window.innerWidth<1600&&(o.height=500,o.width=800);let x=o.getBoundingClientRect().left,w=o.getBoundingClientRect().top,a,f,d=-1,g=null,h=1,m=1;function L(e){const t=e.target.files[0],c=new FileReader;c.onload=function(){const n=new Image;n.src=c.result,n.onload=function(){l.scale(o.width/n.width,o.height/n.height),h=o.width/n.width,m=o.height/n.height,g=n,l.drawImage(n,0,0)}},c.readAsDataURL(t)}v.addEventListener("change",L);const s=[];function q(){l.clearRect(0,0,o.width,o.height),g&&l.drawImage(g,0,0);for(let e=0;e<s.length;e++){const t=s[e];l.font=`${t.fontSize}px Arial`,l.fillStyle=`${t.color}`,console.log(l.color),l.fillText(t.text,t.x,t.y)}}function E(e,t,c){const n=s[c];return e/h>=n.x&&e/h<=n.x+n.width&&t/m>=n.y-n.height&&t/m<=n.y}function I(e){e.preventDefault(),a=parseInt(e.clientX-x),f=parseInt(e.clientY-w);for(let t=0;t<s.length;t++)E(a,f,t)&&(d=t)}function T(e){e.preventDefault(),d=-1}function b(e){e.preventDefault(),d=-1}function D(e){if(d<0)return;e.preventDefault();const t=parseInt(e.clientX-x),c=parseInt(e.clientY-w),n=t-a,r=c-f;a=t,f=c;const i=s[d];i.x+=n/h,i.y+=r/m,q()}const M=document.querySelector("#text_manager").querySelector("button");M.addEventListener("click",()=>{const e=u.querySelector("#fontValue").innerText;l.font=`${e}px Arial`,l.fillStyle=`${y.value}`;const t={text:S.value,x:300,y:300,fontSize:e,color:y.value};t.width=l.measureText(t.text).width,t.height=60,l.fillText(t.text,t.x,t.y),s.push(t)});o.addEventListener("mousedown",e=>I(e));o.addEventListener("mousemove",e=>D(e));o.addEventListener("mouseup",e=>T(e));o.addEventListener("mouseout",e=>b(e));const N=document.querySelector("#download");N.addEventListener("click",()=>{const e=document.createElement("a");e.download="download",e.href=o.toDataURL(["image/png"]),e.click()});u.querySelector("#fontUp").addEventListener("click",()=>{const e=u.querySelector("#fontValue").innerText;Number(e)<100&&(u.querySelector("#fontValue").innerHTML=Number(e)+1)});u.querySelector("#fontDown").addEventListener("click",()=>{const e=u.querySelector("#fontValue").innerText;Number(e)>2&&(u.querySelector("#fontValue").innerText=Number(e)-1)});
